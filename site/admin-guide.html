<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Guide | BlueMoxon Documentation</title>
    <meta name="description" content="Complete administrator guide for BlueMoxon - managing books, images, users, and the collection">

    <!-- Favicons -->
    <link rel="icon" href="/favicon.ico" sizes="48x48">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-primary: #0a0f1a;
            --bg-secondary: #111827;
            --bg-card: #1a2332;
            --bg-code: #0d1117;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --accent-blue: #3b82f6;
            --accent-blue-light: #60a5fa;
            --accent-purple: #8b5cf6;
            --accent-green: #10b981;
            --accent-amber: #f59e0b;
            --accent-red: #ef4444;
            --border-color: #1e293b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(10, 15, 26, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            z-index: 1000;
            padding: 0.75rem 2rem;
        }

        nav .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        nav .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
        }

        nav .logo img {
            height: 48px;
            width: auto;
        }

        nav .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
            margin: 0;
            padding: 0;
        }

        nav .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: color 0.2s;
        }

        nav .nav-links a:hover {
            color: var(--accent-blue-light);
        }

        .btn-login {
            background: linear-gradient(135deg, var(--accent-blue) 0%, var(--accent-purple) 100%);
            color: white;
            padding: 0.5rem 1.25rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.2s;
            white-space: nowrap;
        }
        .btn-login:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        /* Layout */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 72px;
            left: 0;
            width: 280px;
            height: calc(100vh - 72px);
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            padding: 2rem 1.5rem;
            overflow-y: auto;
        }

        .sidebar h3 {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            margin-bottom: 1rem;
            margin-top: 2rem;
        }

        .sidebar h3:first-child {
            margin-top: 0;
        }

        .sidebar ul {
            list-style: none;
        }

        .sidebar li {
            margin-bottom: 0.5rem;
        }

        .sidebar a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            display: block;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .sidebar a:hover {
            background: var(--bg-card);
            color: var(--accent-blue-light);
        }

        .sidebar a.active {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-blue-light);
            border-left: 3px solid var(--accent-blue);
        }

        /* Main Content */
        main {
            margin-left: 280px;
            padding: 5rem 3rem 4rem;
            max-width: 900px;
        }

        /* Page Header */
        .page-header {
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-color);
        }

        .page-header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .page-header .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .breadcrumb {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .breadcrumb a {
            color: var(--accent-blue-light);
            text-decoration: none;
        }

        .breadcrumb span {
            color: var(--text-muted);
        }

        /* Section Styling */
        section {
            margin-bottom: 4rem;
        }

        section h2 {
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 2rem 0 1rem;
            color: var(--text-primary);
        }

        section p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        /* Screenshots */
        .screenshot {
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            margin: 1.5rem 0;
        }

        .screenshot img {
            width: 100%;
            display: block;
        }

        .screenshot .caption {
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            color: var(--text-muted);
            font-size: 0.85rem;
            border-top: 1px solid var(--border-color);
        }

        /* Feature Cards */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .feature-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
        }

        .feature-card h4 {
            color: var(--accent-blue-light);
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .feature-card p {
            font-size: 0.9rem;
            margin-bottom: 0;
        }

        /* Lists */
        ul, ol {
            color: var(--text-secondary);
            margin: 1rem 0 1.5rem 1.5rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        li strong {
            color: var(--text-primary);
        }

        /* Code Blocks */
        code {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-code);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85em;
            color: var(--accent-amber);
        }

        pre {
            background: var(--bg-code);
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
            border: 1px solid var(--border-color);
            margin: 1rem 0;
        }

        pre code {
            background: none;
            padding: 0;
            color: var(--text-primary);
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: var(--bg-secondary);
            color: var(--text-muted);
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        td {
            color: var(--text-secondary);
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-blue { background: rgba(59, 130, 246, 0.2); color: var(--accent-blue-light); }
        .badge-green { background: rgba(16, 185, 129, 0.2); color: var(--accent-green); }
        .badge-amber { background: rgba(245, 158, 11, 0.2); color: var(--accent-amber); }
        .badge-red { background: rgba(239, 68, 68, 0.2); color: var(--accent-red); }

        /* Alerts */
        .alert {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            border-left: 4px solid;
        }

        .alert-info {
            background: rgba(59, 130, 246, 0.1);
            border-color: var(--accent-blue);
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.1);
            border-color: var(--accent-amber);
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border-color: var(--accent-green);
        }

        .alert strong {
            color: var(--text-primary);
        }

        /* Step Lists */
        .steps {
            counter-reset: step;
            list-style: none;
            margin-left: 0;
        }

        .steps li {
            position: relative;
            padding-left: 3rem;
            margin-bottom: 1.5rem;
        }

        .steps li::before {
            counter-increment: step;
            content: counter(step);
            position: absolute;
            left: 0;
            top: 0;
            width: 2rem;
            height: 2rem;
            background: var(--accent-blue);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.85rem;
        }

        /* Hamburger button */
        .hamburger {
            display: none;
            flex-direction: column;
            justify-content: space-around;
            width: 28px;
            height: 24px;
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            z-index: 1001;
        }

        .hamburger span {
            width: 100%;
            height: 3px;
            background: var(--text-primary);
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        .footer-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.2s;
        }
        .footer-links a:hover {
            color: var(--accent-blue-light);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                display: none;
            }

            main {
                margin-left: 0;
                padding: 5rem 1.5rem 3rem;
            }
        }

        @media (max-width: 768px) {
            .btn-login {
                display: none;
            }

            nav {
                padding: 0.5rem 1rem;
            }

            nav .logo img {
                height: 44px;
            }

            .hamburger {
                display: flex;
            }

            nav .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(10, 15, 26, 0.98);
                flex-direction: column;
                padding: 1rem;
                gap: 0;
                border-bottom: 1px solid var(--border-color);
            }

            nav .nav-links.active {
                display: flex;
            }

            nav .nav-links li {
                padding: 0.75rem 0;
                border-bottom: 1px solid var(--border-color);
            }

            nav .nav-links li:last-child {
                border-bottom: none;
            }

            nav .nav-links a {
                font-size: 1rem;
            }

            /* Main content */
            main {
                padding: 4rem 1rem 2rem;
            }

            .page-header h1 {
                font-size: 1.75rem;
            }

            .page-header .subtitle {
                font-size: 1rem;
            }

            section h2 {
                font-size: 1.4rem;
            }

            section h3 {
                font-size: 1.1rem;
            }

            /* Feature grid - single column */
            .feature-grid {
                grid-template-columns: 1fr;
            }

            /* Tables - horizontal scroll */
            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }

            th, td {
                padding: 0.5rem 0.75rem;
                font-size: 0.85rem;
            }

            /* Code blocks */
            pre {
                padding: 1rem;
                font-size: 0.75rem;
            }

            code {
                font-size: 0.8em;
            }

            /* Screenshots */
            .screenshot .caption {
                padding: 0.75rem 1rem;
                font-size: 0.8rem;
            }

            /* Alerts */
            .alert {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }

            /* Steps */
            .steps li {
                padding-left: 2.5rem;
            }

            .steps li::before {
                width: 1.75rem;
                height: 1.75rem;
                font-size: 0.75rem;
            }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
            main {
                padding: 3.5rem 0.75rem 1.5rem;
            }

            .page-header h1 {
                font-size: 1.5rem;
            }

            section h2 {
                font-size: 1.25rem;
            }

            pre {
                font-size: 0.65rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="nav-content">
            <a href="/" class="logo">
                <img src="/images/bluemoxon-logo.png" alt="BlueMoxon" height="40">
            </a>
            <button class="hamburger" aria-label="Toggle menu" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-links">
                <li><a href="/#whats-new">What's New</a></li>
                <li><a href="/#features">Features</a></li>
                <li><a href="/#screenshots">Screenshots</a></li>
                <li><a href="/#about">About</a></li>
                <li><a href="/tech.html">How It's Built</a></li>
            </ul>
            <a href="https://app.bluemoxon.com" class="btn-login" target="_blank">Login</a>
        </div>
    </nav>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h3>Getting Started</h3>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#authentication">Authentication</a></li>
            </ul>

            <h3>Book Management</h3>
            <ul>
                <li><a href="#adding-books">Adding Books</a></li>
                <li><a href="#editing-books">Editing Books</a></li>
                <li><a href="#deleting-books">Deleting Books</a></li>
                <li><a href="#status-tracking">Status Tracking</a></li>
            </ul>

            <h3>Acquisitions</h3>
            <ul>
                <li><a href="#acquisitions-dashboard">Acquisitions Dashboard</a></li>
                <li><a href="#ebay-import">eBay Import</a></li>
                <li><a href="#shipment-tracking">Shipment Tracking</a></li>
                <li><a href="#investment-scoring">Investment Scoring</a></li>
                <li><a href="#wayback-archive">Wayback Archive</a></li>
            </ul>

            <h3>Images & Media</h3>
            <ul>
                <li><a href="#uploading-images">Uploading Images</a></li>
                <li><a href="#reordering-images">Reordering Images</a></li>
                <li><a href="#image-gallery">Image Gallery</a></li>
            </ul>

            <h3>AI Analysis</h3>
            <ul>
                <li><a href="#analysis-editor">Analysis Editor</a></li>
                <li><a href="#async-analysis">Async Generation</a></li>
                <li><a href="#markdown-formatting">Markdown Formatting</a></li>
            </ul>

            <h3>Reference Data</h3>
            <ul>
                <li><a href="#entity-management">Entity Management</a></li>
                <li><a href="#authors">Authors</a></li>
                <li><a href="#publishers">Publishers</a></li>
                <li><a href="#binders">Binders</a></li>
                <li><a href="#entity-reassignment">Entity Reassignment</a></li>
            </ul>

            <h3>BMX 3.0 Administration</h3>
            <ul>
                <li><a href="#the-common-thread-admin">The Common Thread</a></li>
                <li><a href="#entity-profiles">Entity Profiles</a></li>
                <li><a href="#portrait-sync">Portrait Sync</a></li>
                <li><a href="#model-configuration">Model Configuration</a></li>
            </ul>

            <h3>Maintenance</h3>
            <ul>
                <li><a href="#garbage-review">Garbage Image Review</a></li>
                <li><a href="#orphan-cleanup">Orphan Cleanup</a></li>
            </ul>

            <h3>Appearance</h3>
            <ul>
                <li><a href="#dark-mode">Victorian Dark Mode</a></li>
            </ul>

            <h3>Dashboard</h3>
            <ul>
                <li><a href="#dashboard-stats">Statistics</a></li>
                <li><a href="#filtering">Filtering & Search</a></li>
            </ul>

            <h3>User Management</h3>
            <ul>
                <li><a href="#user-roles">User Roles</a></li>
                <li><a href="#cognito-admin">Cognito Admin</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main>
            <div class="breadcrumb">
                <a href="index.html">Docs</a>
                <span>/</span>
                <span>Admin Guide</span>
            </div>

            <div class="page-header">
                <h1>Administrator Guide</h1>
                <p class="subtitle">Complete guide to managing your BlueMoxon collection</p>
            </div>

            <!-- Overview Section -->
            <section id="overview">
                <h2>Overview</h2>
                <p>
                    BlueMoxon provides a full-featured admin interface for managing your rare book collection.
                    Authenticated users can add, edit, and delete books, upload images, write analysis documents,
                    and manage reference data like authors and publishers.
                </p>

                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>Book Management</h4>
                        <p>Full CRUD operations for books with comprehensive metadata fields.</p>
                    </div>
                    <div class="feature-card">
                        <h4>Image Handling</h4>
                        <p>Upload, reorder, and manage images with CDN delivery.</p>
                    </div>
                    <div class="feature-card">
                        <h4>Analysis Documents</h4>
                        <p>Rich markdown editor with live preview for detailed analyses.</p>
                    </div>
                    <div class="feature-card">
                        <h4>Reference Data</h4>
                        <p>Manage authors, publishers, and binders with autocomplete.</p>
                    </div>
                </div>
            </section>

            <!-- Authentication Section -->
            <section id="authentication">
                <h2>Authentication</h2>
                <p>
                    BlueMoxon uses <strong>AWS Cognito</strong> for authentication. Users must sign in to access
                    admin features like adding or editing books.
                </p>

                <div class="alert alert-info">
                    <strong>Note:</strong> Public visitors can browse the collection and view book details,
                    but cannot modify any data. Admin features are only visible to authenticated users.
                </div>

                <h3>Signing In</h3>
                <ol class="steps">
                    <li>Click the <strong>Sign In</strong> button in the navigation bar</li>
                    <li>Enter your email address and password</li>
                    <li>If you have MFA enabled, enter your verification code</li>
                    <li>Upon successful login, you'll see admin controls appear throughout the interface</li>
                </ol>

                <h3>Session Management</h3>
                <p>
                    JWT tokens are stored securely and automatically refreshed. Sessions typically last 1 hour,
                    with automatic refresh for up to 30 days of continuous use.
                </p>
            </section>

            <!-- Adding Books Section -->
            <section id="adding-books">
                <h2>Adding Books</h2>
                <p>
                    New books can be added through the web interface or via the REST API. The web form provides
                    guided input with dropdowns for reference data and validation for required fields.
                </p>

                <div class="screenshot">
                    <img src="https://bluemoxon.com/screenshots/admin-add-book.png" alt="Add Book Form">
                    <div class="caption">The Add Book form with basic information fields</div>
                </div>

                <h3>Required Fields</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Description</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Title</strong></td>
                            <td>Book title (do not include author/publisher)</td>
                            <td>Essays of Elia</td>
                        </tr>
                        <tr>
                            <td><strong>Author</strong></td>
                            <td>Select from dropdown or create new</td>
                            <td>Charles Lamb</td>
                        </tr>
                        <tr>
                            <td><strong>Publisher</strong></td>
                            <td>Publisher and location</td>
                            <td>Dent, London</td>
                        </tr>
                        <tr>
                            <td><strong>Publication Date</strong></td>
                            <td>Year of publication</td>
                            <td>1867</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Optional Fields</h3>
                <ul>
                    <li><strong>Volumes:</strong> Number of volumes (default: 1)</li>
                    <li><strong>Binding Type:</strong> Morocco, calf, vellum, cloth, etc.</li>
                    <li><strong>Binder:</strong> Known binder (Rivi√®re, Zaehnsdorf, etc.)</li>
                    <li><strong>Inventory Type:</strong> PRIMARY, EXTENDED, or FLAGGED</li>
                    <li><strong>Value Range:</strong> Low, mid, and high estimates in USD</li>
                    <li><strong>Purchase Price:</strong> Actual acquisition cost</li>
                    <li><strong>Purchase Date:</strong> When acquired</li>
                    <li><strong>Order Number:</strong> eBay/Etsy order reference</li>
                    <li><strong>Place of Purchase:</strong> eBay, Etsy, AbeBooks, etc.</li>
                    <li><strong>Notes:</strong> Free-form notes</li>
                </ul>

                <div class="screenshot">
                    <img src="https://bluemoxon.com/screenshots/admin-add-book-2.png" alt="Add Book Form - Binding Section">
                    <div class="caption">Binding, condition, and valuation fields</div>
                </div>

                <div class="alert alert-warning">
                    <strong>Tip:</strong> Keep titles clean! Don't include author names, volume counts, or
                    binding descriptions in the title field - use the dedicated fields instead.
                </div>
            </section>

            <!-- Editing Books Section -->
            <section id="editing-books">
                <h2>Editing Books</h2>
                <p>
                    Existing books can be edited by clicking the <strong>Edit</strong> button on any book detail page.
                    All fields are editable, and changes are saved immediately when you click Save.
                </p>

                <div class="screenshot">
                    <img src="https://bluemoxon.com/screenshots/admin-edit-book.png" alt="Edit Book Form">
                    <div class="caption">The Edit Book form with pre-populated fields</div>
                </div>

                <h3>Edit Actions</h3>
                <ul>
                    <li><strong>Edit Metadata:</strong> Modify any book field</li>
                    <li><strong>Update Status:</strong> Change delivery status (IN_TRANSIT, ON_HAND)</li>
                    <li><strong>Edit Analysis:</strong> Open the markdown editor for analysis documents</li>
                    <li><strong>Manage Images:</strong> Add, remove, or reorder images</li>
                </ul>
            </section>

            <!-- Deleting Books Section -->
            <section id="deleting-books">
                <h2>Deleting Books</h2>
                <p>
                    Books can be permanently deleted from the book detail page. This action requires confirmation
                    and cannot be undone.
                </p>

                <div class="alert alert-warning">
                    <strong>Warning:</strong> Deleting a book also removes all associated images and analysis
                    documents. Consider exporting a CSV backup before deleting.
                </div>

                <ol class="steps">
                    <li>Navigate to the book detail page</li>
                    <li>Click the <strong>Delete</strong> button (red, typically in the action bar)</li>
                    <li>Confirm the deletion in the modal dialog</li>
                    <li>The book and all associated data will be permanently removed</li>
                </ol>
            </section>

            <!-- Status Tracking Section -->
            <section id="status-tracking">
                <h2>Status Tracking</h2>
                <p>
                    Books can have different delivery statuses to track acquisitions from purchase to arrival.
                </p>

                <table>
                    <thead>
                        <tr>
                            <th>Status</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-amber">IN_TRANSIT</span></td>
                            <td>Purchased but not yet received</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-green">ON_HAND</span></td>
                            <td>Physically in the collection</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-blue">SOLD</span></td>
                            <td>Sold or transferred out of collection</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-red">REMOVED</span></td>
                            <td>Removed from collection (damaged, lost, etc.)</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Updating Status via API</h3>
                <pre><code>curl -X PATCH "https://api.bluemoxon.com/api/v1/books/{id}/status?status=ON_HAND" \
  -H "X-API-Key: $BMX_API_KEY"</code></pre>
            </section>

            <!-- Acquisitions Dashboard Section -->
            <section id="acquisitions-dashboard">
                <h2>Acquisitions Dashboard</h2>
                <p>
                    The Acquisitions Dashboard is your command center for tracking book purchases from discovery
                    through delivery. Access it from <strong>Admin &rarr; Acquisitions</strong> in the navigation.
                </p>

                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>Watchlist</h4>
                        <p>Track potential acquisitions you're considering. Import eBay listings for research before committing to purchase.</p>
                    </div>
                    <div class="feature-card">
                        <h4>In Transit</h4>
                        <p>Monitor purchased items awaiting delivery. Track order numbers and expected arrival dates.</p>
                    </div>
                    <div class="feature-card">
                        <h4>On Hand</h4>
                        <p>Recent arrivals ready for cataloging. Convert to full collection entries with a single click.</p>
                    </div>
                    <div class="feature-card">
                        <h4>Investment Scores</h4>
                        <p>Each acquisition receives Investment Grade (0-100) and Strategic Fit (0-7) scores at import time.</p>
                    </div>
                </div>

                <h3>Acquisition Workflow</h3>
                <p>The typical workflow follows this progression:</p>
                <ol class="steps">
                    <li><strong>Discover:</strong> Find a listing on eBay, Etsy, or another marketplace</li>
                    <li><strong>Import:</strong> Paste the URL into the Acquisitions Dashboard to auto-populate details</li>
                    <li><strong>Evaluate:</strong> Review the AI-generated investment scores and valuation estimate</li>
                    <li><strong>Purchase:</strong> If the scores warrant, complete the purchase and update status to "In Transit"</li>
                    <li><strong>Receive:</strong> When the book arrives, mark as "On Hand" and convert to collection entry</li>
                </ol>
            </section>

            <!-- eBay Import Section -->
            <section id="ebay-import">
                <h2>eBay Import</h2>
                <p>
                    The eBay Import feature lets you paste a listing URL to automatically extract title, price,
                    seller, images, and other metadata. This eliminates manual data entry and preserves the
                    original listing information.
                </p>

                <h3>How to Import</h3>
                <ol class="steps">
                    <li>Copy the eBay listing URL from your browser</li>
                    <li>Navigate to <strong>Admin &rarr; Acquisitions</strong></li>
                    <li>Click <strong>Import from eBay</strong></li>
                    <li>Paste the URL and click <strong>Import</strong></li>
                    <li>Review the extracted data and adjust if needed</li>
                    <li>Save to add to your Watchlist or directly to In Transit</li>
                </ol>

                <h3>Extracted Fields</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Source</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Title</strong></td>
                            <td>Listing title (cleaned up)</td>
                        </tr>
                        <tr>
                            <td><strong>Price</strong></td>
                            <td>Current/sold price (converted to USD)</td>
                        </tr>
                        <tr>
                            <td><strong>Seller</strong></td>
                            <td>Seller username</td>
                        </tr>
                        <tr>
                            <td><strong>Images</strong></td>
                            <td>All listing images (CDN links)</td>
                        </tr>
                        <tr>
                            <td><strong>Item Number</strong></td>
                            <td>eBay item ID for reference</td>
                        </tr>
                        <tr>
                            <td><strong>Description</strong></td>
                            <td>Listing description (if available)</td>
                        </tr>
                    </tbody>
                </table>

                <div class="alert alert-info">
                    <strong>Tip:</strong> Import works best with active listings. Ended/sold listings may have
                    limited data availability. Consider using Wayback Archive to preserve listing details.
                </div>

                <h3>Supported Formats</h3>
                <p>The importer accepts various eBay URL formats:</p>
                <ul>
                    <li><code>https://www.ebay.com/itm/123456789</code></li>
                    <li><code>https://www.ebay.co.uk/itm/123456789</code></li>
                    <li><code>https://ebay.com/itm/title-slug/123456789</code></li>
                </ul>
            </section>

            <!-- Investment Scoring Section -->
            <section id="investment-scoring">
                <h2>Investment Scoring</h2>
                <p>
                    Every acquisition is automatically scored at import time using a proprietary algorithm that
                    considers binding quality, author significance, collection fit, and purchase economics.
                </p>

                <h3>Investment Grade (0-100)</h3>
                <p>
                    The Investment Grade measures the overall investment potential of an acquisition. Higher scores
                    indicate better value propositions based on multiple factors.
                </p>

                <table>
                    <thead>
                        <tr>
                            <th>Score Range</th>
                            <th>Rating</th>
                            <th>Interpretation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-green">80-100</span></td>
                            <td>Excellent</td>
                            <td>Strong buy - exceptional value and fit</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-blue">60-79</span></td>
                            <td>Good</td>
                            <td>Solid acquisition - good value proposition</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-amber">40-59</span></td>
                            <td>Fair</td>
                            <td>Consider carefully - some concerns</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-red">0-39</span></td>
                            <td>Poor</td>
                            <td>Pass recommended - weak value</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Strategic Fit (0-7)</h3>
                <p>
                    Strategic Fit measures how well an acquisition aligns with your collection focus. This score
                    considers your target author list, preferred publishers, and binding priorities.
                </p>

                <h4>Scoring Factors</h4>
                <ul>
                    <li><strong>+2:</strong> Priority 1 target author</li>
                    <li><strong>+1:</strong> Priority 2-3 target author</li>
                    <li><strong>+1:</strong> Tier 1 publisher (Moxon, Pickering, etc.)</li>
                    <li><strong>+1:</strong> Premium binding (full morocco, signed binder)</li>
                    <li><strong>+1:</strong> Victorian era poetry (collection focus)</li>
                    <li><strong>+1:</strong> Multi-volume set</li>
                    <li><strong>+1:</strong> Extra-illustrated or unique features</li>
                </ul>

                <div class="alert alert-success">
                    <strong>Historical Tracking:</strong> Scores are captured at acquisition time and preserved
                    with the book record. This allows you to analyze your purchasing decisions over time and
                    refine your scoring criteria.
                </div>
            </section>

            <!-- Wayback Archive Section -->
            <section id="wayback-archive">
                <h2>Wayback Archive</h2>
                <p>
                    The Wayback Archive feature automatically saves a snapshot of eBay listings to the Internet
                    Archive. This preserves the original listing details, images, and pricing for future reference
                    even after the listing expires or is removed.
                </p>

                <h3>Why Archive Listings?</h3>
                <ul>
                    <li><strong>Provenance Documentation:</strong> Preserve the original listing as purchase evidence</li>
                    <li><strong>Price Verification:</strong> Original asking price for insurance or resale records</li>
                    <li><strong>Condition Records:</strong> Seller's description at time of purchase</li>
                    <li><strong>Image Backup:</strong> Original images even if eBay removes them</li>
                </ul>

                <h3>How It Works</h3>
                <ol class="steps">
                    <li>When you import an eBay listing, the system submits the URL to the Wayback Machine</li>
                    <li>The archive URL is stored with the acquisition record</li>
                    <li>Access the archived version anytime from the acquisition details</li>
                    <li>Archive links are also preserved when converting to collection entries</li>
                </ol>

                <div class="alert alert-info">
                    <strong>Note:</strong> Archive snapshots may take a few minutes to become available.
                    The system stores the archive request URL immediately, but the actual snapshot is
                    processed asynchronously by the Internet Archive.
                </div>

                <h3>Viewing Archived Listings</h3>
                <p>
                    Click the <strong>View Archive</strong> link on any acquisition to open the preserved
                    listing in a new tab. The archive shows the listing exactly as it appeared at capture time.
                </p>
            </section>

            <!-- Shipment Tracking Section -->
            <section id="shipment-tracking">
                <h2>Shipment Tracking</h2>
                <p>
                    Track your in-transit acquisitions with automatic carrier detection and real-time status updates.
                    Add a tracking number to any book and BlueMoxon generates the tracking URL automatically.
                </p>

                <h3>Adding Tracking Information</h3>
                <ol class="steps">
                    <li>Navigate to the book detail page for an in-transit acquisition</li>
                    <li>Click <strong>Add Tracking</strong> in the status section</li>
                    <li>Enter the tracking number - the carrier is detected automatically</li>
                    <li>Click <strong>Save</strong> to store the tracking information</li>
                    <li>Click the tracking link to open the carrier's tracking page</li>
                </ol>

                <h3>Supported Carriers</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Carrier</th>
                            <th>Detection Pattern</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>USPS</strong></td>
                            <td>20-22 digits starting with 9</td>
                            <td>9400111899223100123456</td>
                        </tr>
                        <tr>
                            <td><strong>UPS</strong></td>
                            <td>1Z followed by alphanumeric</td>
                            <td>1Z999AA10123456784</td>
                        </tr>
                        <tr>
                            <td><strong>FedEx</strong></td>
                            <td>12-15 or 20-22 digits</td>
                            <td>123456789012</td>
                        </tr>
                        <tr>
                            <td><strong>Royal Mail</strong></td>
                            <td>2 letters + 9 digits + GB</td>
                            <td>AB123456789GB</td>
                        </tr>
                        <tr>
                            <td><strong>DHL</strong></td>
                            <td>10 digits</td>
                            <td>1234567890</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Tracking Status</h3>
                <p>
                    Click <strong>Refresh Status</strong> to update the tracking status from the carrier.
                    Status values include: pending, in_transit, out_for_delivery, delivered, exception.
                </p>

                <div class="alert alert-info">
                    <strong>Tip:</strong> When a package shows as "delivered", you'll see a prompt to mark
                    the book as ON_HAND and move it to your collection.
                </div>
            </section>

            <!-- Uploading Images Section -->
            <section id="uploading-images">
                <h2>Uploading Images</h2>
                <p>
                    Each book can have multiple images. The first image (or designated primary) appears as the
                    thumbnail in collection views.
                </p>

                <ol class="steps">
                    <li>Navigate to the book detail page</li>
                    <li>Click <strong>Add Images</strong> in the image section</li>
                    <li>Select one or more image files (JPG, PNG supported)</li>
                    <li>Images are uploaded to S3 and served via CloudFront CDN</li>
                    <li>The page refreshes to show newly uploaded images</li>
                </ol>

                <div class="alert alert-info">
                    <strong>Tip:</strong> Images are automatically optimized for web delivery. Large originals
                    are preserved while thumbnails are generated for fast loading.
                </div>
            </section>

            <!-- Reordering Images Section -->
            <section id="reordering-images">
                <h2>Reordering Images</h2>
                <p>
                    Image order can be changed using drag-and-drop or the <strong>Reorder</strong> button.
                    The first image becomes the primary thumbnail.
                </p>

                <div class="screenshot">
                    <img src="https://bluemoxon.com/screenshots/admin-book-detail.png" alt="Book Detail with Image Controls">
                    <div class="caption">Book detail page showing Edit, Delete, Add Images, and Reorder buttons</div>
                </div>

                <h3>Image Actions</h3>
                <ul>
                    <li><strong>Reorder:</strong> Drag images to change their display order</li>
                    <li><strong>Set Primary:</strong> Click to make an image the main thumbnail</li>
                    <li><strong>Delete:</strong> Remove individual images</li>
                    <li><strong>View Full Size:</strong> Click to open in lightbox gallery</li>
                </ul>
            </section>

            <!-- Image Gallery Section -->
            <section id="image-gallery">
                <h2>Image Gallery</h2>
                <p>
                    Clicking any image opens a full-screen lightbox with navigation controls.
                    Supports keyboard navigation (arrow keys) and swipe gestures on mobile.
                </p>

                <div class="screenshot">
                    <img src="https://bluemoxon.com/screenshots/image-gallery.png" alt="Image Gallery Lightbox">
                    <div class="caption">Full-screen image gallery with thumbnail navigation</div>
                </div>
            </section>

            <!-- Analysis Editor Section -->
            <section id="analysis-editor">
                <h2>Analysis Editor</h2>
                <p>
                    Each book can have a detailed analysis document written in Markdown. The editor provides
                    live preview and supports the full Napoleon Framework for rare book evaluation.
                </p>

                <div class="screenshot">
                    <img src="https://bluemoxon.com/screenshots/analysis.png" alt="Analysis View">
                    <div class="caption">Rendered analysis document with professional valuation report format</div>
                </div>

                <h3>Analysis Sections</h3>
                <ul>
                    <li><strong>Executive Summary:</strong> Brief overview and significance</li>
                    <li><strong>Provenance:</strong> History and previous ownership</li>
                    <li><strong>Physical Description:</strong> Binding, paper, condition details</li>
                    <li><strong>Valuation:</strong> Market analysis and comparable sales</li>
                    <li><strong>Recommendation:</strong> BUY / PASS / CONDITIONAL BUY</li>
                </ul>
            </section>

            <!-- Async Analysis Section -->
            <section id="async-analysis">
                <h2>Async Analysis Generation</h2>
                <p>
                    For complex analyses that require extended processing time, BlueMoxon uses asynchronous
                    generation via SQS queues. This allows analyses to run without timeout limits and provides
                    real-time progress updates.
                </p>

                <h3>How Async Analysis Works</h3>
                <ol class="steps">
                    <li>Click <strong>Generate Analysis</strong> on a book detail page</li>
                    <li>Select your preferred model (Sonnet for speed, Opus for quality)</li>
                    <li>The job is submitted to the analysis queue</li>
                    <li>Monitor progress in real-time - status updates every few seconds</li>
                    <li>When complete, the analysis appears automatically</li>
                </ol>

                <h3>Job Status</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Status</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-amber">pending</span></td>
                            <td>Job submitted, waiting in queue</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-blue">running</span></td>
                            <td>Analysis in progress</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-green">completed</span></td>
                            <td>Analysis finished successfully</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-red">failed</span></td>
                            <td>Error occurred - check error message</td>
                        </tr>
                    </tbody>
                </table>

                <div class="alert alert-info">
                    <strong>Note:</strong> Async generation is automatically used for Opus model requests
                    and for books with many images. Simpler analyses may complete synchronously.
                </div>

                <h3>Model Version Tracking</h3>
                <p>
                    Each analysis records the AI model version used (e.g., "claude-sonnet-4-20250514").
                    This allows you to track which model generated each analysis and compare results
                    over time as models improve.
                </p>
            </section>

            <!-- Markdown Formatting Section -->
            <section id="markdown-formatting">
                <h2>Markdown Formatting</h2>
                <p>
                    The analysis editor supports GitHub-flavored Markdown with tables, code blocks, and more.
                </p>

                <pre><code># Book Title

## Executive Summary
Brief overview of the book's significance...

## Physical Description
| Attribute | Value |
|-----------|-------|
| Binding | Full morocco |
| Condition | Very good |

## Valuation
- **Low estimate:** $200
- **Mid estimate:** $275
- **High estimate:** $350</code></pre>
            </section>

            <!-- Entity Management Section -->
            <section id="entity-management">
                <h2>Entity Management</h2>
                <p>
                    The Reference Data tab in the Admin Config provides a full CRUD interface for managing
                    authors, publishers, and binders. Access it from <strong>Config ‚Üí Reference Data</strong>.
                </p>

                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>Create Entities</h4>
                        <p>Add new authors, publishers, or binders with all relevant metadata fields.</p>
                    </div>
                    <div class="feature-card">
                        <h4>Edit Entities</h4>
                        <p>Update entity details, set tier classifications, mark as preferred.</p>
                    </div>
                    <div class="feature-card">
                        <h4>Delete Entities</h4>
                        <p>Remove entities with no associated books. Entities with books must be reassigned first.</p>
                    </div>
                    <div class="feature-card">
                        <h4>Reassign Books</h4>
                        <p>Move all books from one entity to another, then delete the source entity.</p>
                    </div>
                </div>

                <h3>Preferred Entities</h3>
                <p>
                    Mark entities as "preferred" to give books by that author, publisher, or binder a
                    <strong>+10 point bonus</strong> in investment scoring. Use this for collection priorities
                    that don't fit into the tier system.
                </p>

                <h3>Tier Classifications</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Tier</th>
                            <th>Bonus</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-green">Tier 1</span></td>
                            <td>+15 pts</td>
                            <td>Premium/most desirable (e.g., Dickens, Zaehnsdorf)</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-blue">Tier 2</span></td>
                            <td>+10 pts</td>
                            <td>Notable/collectible (e.g., Darwin, Rivi√®re)</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-amber">Tier 3</span></td>
                            <td>+5 pts</td>
                            <td>Of interest (e.g., lesser-known Victorian authors)</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Authors Section -->
            <section id="authors">
                <h2>Authors</h2>
                <p>
                    Authors are managed as reference data and can be selected when adding or editing books.
                    New authors are created automatically when entering a new name.
                </p>

                <h3>Author Fields</h3>
                <ul>
                    <li><strong>Name:</strong> Full name (e.g., "Charles Dickens")</li>
                    <li><strong>Birth Year:</strong> Optional birth year</li>
                    <li><strong>Death Year:</strong> Optional death year</li>
                    <li><strong>Era:</strong> Victorian, Romantic, Georgian, etc.</li>
                    <li><strong>Tier:</strong> Tier 1, 2, or 3 classification</li>
                    <li><strong>Preferred:</strong> Mark for +10 scoring bonus</li>
                    <li><strong>Priority Score:</strong> Numeric priority for target acquisitions</li>
                </ul>
            </section>

            <!-- Publishers Section -->
            <section id="publishers">
                <h2>Publishers</h2>
                <p>
                    Publishers include both the company name and location. Common formats include
                    "Chapman and Hall, London" or "Scribner's, New York".
                </p>

                <h3>Publisher Fields</h3>
                <ul>
                    <li><strong>Name:</strong> Publisher name (e.g., "John Murray")</li>
                    <li><strong>Founded:</strong> Year founded (optional)</li>
                    <li><strong>Description:</strong> Notes about the publisher</li>
                    <li><strong>Tier:</strong> Tier 1, 2, or 3 classification</li>
                    <li><strong>Preferred:</strong> Mark for +10 scoring bonus</li>
                </ul>
            </section>

            <!-- Binders Section -->
            <section id="binders">
                <h2>Binders</h2>
                <p>
                    For books with identified bindings by known binderies. Common examples include
                    Rivi√®re, Zaehnsdorf, Sangorski & Sutcliffe, and Root & Son.
                </p>

                <h3>Binder Fields</h3>
                <ul>
                    <li><strong>Name:</strong> Short name (e.g., "Rivi√®re")</li>
                    <li><strong>Full Name:</strong> Complete name (e.g., "Rivi√®re & Son")</li>
                    <li><strong>Authentication Markers:</strong> How to identify genuine bindings</li>
                    <li><strong>Tier:</strong> Tier 1, 2, or 3 classification</li>
                    <li><strong>Preferred:</strong> Mark for +10 scoring bonus</li>
                </ul>

                <div class="alert alert-info">
                    <strong>Note:</strong> A binder of "Unknown" is used for books with fine bindings
                    where the binder cannot be identified. Leave blank for trade bindings.
                </div>
            </section>

            <!-- Entity Reassignment Section -->
            <section id="entity-reassignment">
                <h2>Entity Reassignment</h2>
                <p>
                    Use reassignment to merge duplicate or variant entities. All books are transferred
                    from the source entity to the target, then the source is deleted.
                </p>

                <h3>Common Use Cases</h3>
                <ul>
                    <li><strong>Merge duplicates:</strong> "W.M. Thackeray" ‚Üí "William Makepeace Thackeray"</li>
                    <li><strong>Consolidate variants:</strong> "Riviere" ‚Üí "Rivi√®re & Son"</li>
                    <li><strong>Fix typos:</strong> "Chapmn and Hall" ‚Üí "Chapman and Hall"</li>
                </ul>

                <h3>How to Reassign</h3>
                <ol class="steps">
                    <li>Navigate to <strong>Config ‚Üí Reference Data</strong></li>
                    <li>Select the entity type tab (Authors, Publishers, or Binders)</li>
                    <li>Find the source entity (the one to be merged away)</li>
                    <li>Click the <strong>Reassign</strong> button (‚ÜîÔ∏è icon)</li>
                    <li>Select the target entity from the dropdown</li>
                    <li>Confirm the operation</li>
                </ol>

                <div class="alert alert-warning">
                    <strong>Warning:</strong> Reassignment is irreversible. All books will be permanently
                    moved to the target entity and the source entity will be deleted.
                </div>
            </section>

            <!-- The Common Thread Administration Section -->
            <section id="the-common-thread-admin">
                <h2>The Common Thread ‚Äî Administration</h2>
                <p>
                    The Common Thread network graph is generated from two data sources: shared commercial
                    relationships (publishers and binders) discovered from your collection data, and
                    AI-discovered personal connections (family, friendship, influence, collaboration, scandal)
                    generated by Claude.
                </p>

                <h3>How the Graph is Generated</h3>
                <ul>
                    <li><strong>Publisher edges:</strong> Two entities sharing the same publisher are connected (green edges)</li>
                    <li><strong>Binder edges:</strong> Two entities sharing the same binder are connected (purple edges)</li>
                    <li><strong>AI connections:</strong> Personal relationships discovered by Claude with confidence scoring and evidence citations</li>
                </ul>

                <h3>Graph Cache Management</h3>
                <p>
                    The network graph data is cached for performance. The cache is automatically refreshed
                    when entities or connections are added, edited, or deleted. You can also manually trigger
                    a cache refresh if needed.
                </p>

                <div class="alert alert-info">
                    <strong>Note:</strong> Graph cache is invalidated automatically when new books, entities,
                    or AI connections are created. Manual refresh is rarely needed but available for
                    troubleshooting.
                </div>
            </section>

            <!-- Entity Profile Management Section -->
            <section id="entity-profiles">
                <h2>Entity Profile Management</h2>
                <p>
                    Entity profiles are AI-generated biographical summaries that include personal stories,
                    connection narratives, and historical context for every author, publisher, and binder
                    in your collection.
                </p>

                <h3>Batch Profile Generation</h3>
                <p>
                    Generate profiles for all entities at once using the batch endpoint. This is useful
                    after initial setup or when you want to refresh all profiles with a newer AI model.
                </p>

                <pre><code># Start batch generation
POST /entity/profiles/generate-all

# Monitor progress
GET /entity/profiles/generate-all/status/{job_id}</code></pre>

                <h3>Regenerate Individual Profiles</h3>
                <p>
                    Regenerate a single entity's profile when you want to refresh it or after updating
                    entity metadata.
                </p>

                <pre><code># Regenerate a specific entity profile
POST /entity/{type}/{id}/profile/regenerate</code></pre>

                <div class="alert alert-info">
                    <strong>Tip:</strong> Profile generation uses the AI model configured for the
                    "entity_profile" workflow in the Model Registry. By default, this uses Haiku for
                    fast, cost-effective generation.
                </div>
            </section>

            <!-- Portrait Sync Section -->
            <section id="portrait-sync">
                <h2>Portrait Sync</h2>
                <p>
                    Portrait Sync automatically discovers and downloads portrait images for entities
                    from Wikidata and Wikimedia Commons. Portraits are matched via SPARQL queries
                    against entity names.
                </p>

                <h3>Automated Pipeline</h3>
                <p>
                    Portrait sync runs automatically as part of the entity enrichment pipeline. When a
                    new entity is created or enriched, the system queries Wikidata for matching portraits
                    and downloads them to the entity's image gallery.
                </p>

                <h3>Manual Trigger</h3>
                <pre><code># Trigger portrait sync for all entities
POST /admin/maintenance/portrait-sync</code></pre>

                <h3>Data Sources</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Source</th>
                            <th>Entity Types</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Wikidata / Wikimedia Commons</strong></td>
                            <td>Authors, Publishers, Binders</td>
                            <td>Primary source. SPARQL queries match entity names to Wikidata items and retrieve portrait images from Wikimedia Commons.</td>
                        </tr>
                        <tr>
                            <td><strong>NLS Historical Maps</strong></td>
                            <td>Publishers, Binders</td>
                            <td>Fallback source. National Library of Scotland historical maps showing publisher and bindery locations in Victorian London.</td>
                        </tr>
                    </tbody>
                </table>

                <div class="alert alert-warning">
                    <strong>Note:</strong> Portrait matching uses fuzzy name matching and may occasionally
                    return incorrect portraits for entities with common names. Review synced portraits
                    in the entity detail view and remove any mismatches.
                </div>
            </section>

            <!-- Model Configuration Section -->
            <section id="model-configuration">
                <h2>Model Configuration</h2>
                <p>
                    BMX 3.0 introduces a Model Registry that allows administrators to configure which
                    AI model is used for each workflow. This provides fine-grained control over cost,
                    speed, and quality tradeoffs.
                </p>

                <h3>Available Models</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>Default Workflow</th>
                            <th>Characteristics</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Opus</strong></td>
                            <td>Book analysis, connection discovery</td>
                            <td>Highest quality. Best for deep analysis and nuanced relationship discovery.</td>
                        </tr>
                        <tr>
                            <td><strong>Sonnet</strong></td>
                            <td>Evaluation runbooks</td>
                            <td>Balanced quality and speed. Good for structured evaluation tasks.</td>
                        </tr>
                        <tr>
                            <td><strong>Haiku</strong></td>
                            <td>Entity profiles, enrichment</td>
                            <td>Fast and cost-effective. Ideal for high-volume profile generation.</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Configuring Models</h3>
                <p>
                    Model assignments can be configured via the admin dashboard under
                    <strong>Config &rarr; Model Registry</strong>, or directly in the
                    <code>app_config</code> table using <code>model.{flow_name}</code> keys.
                </p>

                <pre><code># Example app_config entries
model.book_analysis = "claude-opus-4-20250514"
model.eval_runbook = "claude-sonnet-4-20250514"
model.entity_profile = "claude-haiku-3-20250307"
model.connection_discovery = "claude-opus-4-20250514"</code></pre>

                <div class="alert alert-info">
                    <strong>Tip:</strong> Changes to model configuration take effect immediately for new
                    jobs. In-progress jobs continue using the model they started with. Use the admin
                    dashboard for a visual interface with model descriptions and cost estimates.
                </div>
            </section>

            <!-- Dashboard Stats Section -->
            <section id="dashboard-stats">
                <h2>Dashboard Statistics</h2>
                <p>
                    The dashboard provides real-time statistics about your collection.
                </p>

                <div class="screenshot">
                    <img src="https://bluemoxon.com/screenshots/admin-dashboard.png" alt="Admin Dashboard">
                    <div class="caption">Dashboard with collection statistics and quick actions</div>
                </div>

                <h3>Available Statistics</h3>
                <ul>
                    <li><strong>Total Books:</strong> Count of all books in collection</li>
                    <li><strong>Total Images:</strong> Number of uploaded images</li>
                    <li><strong>Total Value:</strong> Sum of mid-range valuations</li>
                    <li><strong>By Inventory Type:</strong> Primary, Extended, Flagged breakdown</li>
                    <li><strong>By Status:</strong> On Hand vs. In Transit</li>
                    <li><strong>Recent Additions:</strong> Latest books added</li>
                </ul>
            </section>

            <!-- Filtering Section -->
            <section id="filtering">
                <h2>Filtering & Search</h2>
                <p>
                    The collection browser supports multiple filter criteria and full-text search.
                </p>

                <div class="screenshot">
                    <img src="https://bluemoxon.com/screenshots/admin-collection.png" alt="Collection Browser">
                    <div class="caption">Collection browser with filters, search, and sort controls</div>
                </div>

                <h3>Filter Options</h3>
                <ul>
                    <li><strong>Search:</strong> Full-text search across title, author, notes</li>
                    <li><strong>Author:</strong> Filter by specific author</li>
                    <li><strong>Publisher:</strong> Filter by publisher</li>
                    <li><strong>Binding Type:</strong> Morocco, calf, vellum, cloth, etc.</li>
                    <li><strong>Inventory Type:</strong> PRIMARY, EXTENDED, FLAGGED</li>
                    <li><strong>Status:</strong> ON_HAND, IN_TRANSIT, SOLD</li>
                    <li><strong>Date Range:</strong> Filter by publication date</li>
                </ul>

                <h3>Sort Options</h3>
                <ul>
                    <li>Title (A-Z, Z-A)</li>
                    <li>Author (A-Z, Z-A)</li>
                    <li>Publication Date (oldest first, newest first)</li>
                    <li>Date Added (oldest first, newest first)</li>
                    <li>Value (low to high, high to low)</li>
                </ul>
            </section>

            <!-- User Roles Section -->
            <section id="user-roles">
                <h2>User Roles</h2>
                <p>
                    BlueMoxon supports different user roles through Cognito groups. Roles determine
                    what actions users can perform.
                </p>

                <table>
                    <thead>
                        <tr>
                            <th>Role</th>
                            <th>Permissions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="badge badge-green">Admin</span></td>
                            <td>Full access: add, edit, delete books; manage users; all features</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-blue">Editor</span></td>
                            <td>Add and edit books, upload images, write analyses; cannot delete or manage users</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-amber">Viewer</span></td>
                            <td>Read-only access to all book data; cannot make modifications</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-red">Public</span></td>
                            <td>Unauthenticated access; browse-only with limited detail</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- Cognito Admin Section -->
            <section id="cognito-admin">
                <h2>Cognito Administration</h2>
                <p>
                    User accounts are managed through AWS Cognito. Admin users can manage other users
                    via the AWS Console or Cognito APIs.
                </p>

                <h3>Managing Users in AWS Console</h3>
                <ol class="steps">
                    <li>Navigate to the AWS Console and open Cognito</li>
                    <li>Select the BlueMoxon User Pool</li>
                    <li>Click on "Users and groups" in the left sidebar</li>
                    <li>Create, edit, or disable user accounts as needed</li>
                    <li>Assign users to groups (Admin, Editor, Viewer) to set permissions</li>
                </ol>

                <h3>Adding Users to Groups</h3>
                <ol class="steps">
                    <li>In Cognito User Pool, select the "Groups" tab</li>
                    <li>Click on the desired group (e.g., "Admin")</li>
                    <li>Click "Add users to group"</li>
                    <li>Select the user(s) to add</li>
                    <li>The user's role takes effect on their next sign-in</li>
                </ol>

                <h3>Common User Management Tasks</h3>
                <ul>
                    <li><strong>Reset Password:</strong> Use "Reset password" action to send reset email</li>
                    <li><strong>Disable Account:</strong> Toggle user status to disable login</li>
                    <li><strong>Enable MFA:</strong> Configure MFA settings in User Pool settings</li>
                    <li><strong>View Sign-in History:</strong> Check user attributes and last login</li>
                </ul>

                <div class="alert alert-info">
                    <strong>Tip:</strong> For programmatic user management, use the AWS CLI or SDK
                    with the <code>cognito-idp</code> commands.
                </div>

                <pre><code># List users in the pool
aws cognito-idp list-users --user-pool-id us-west-2_XXXXX

# Add user to admin group
aws cognito-idp admin-add-user-to-group \
  --user-pool-id us-west-2_XXXXX \
  --username user@example.com \
  --group-name Admin</code></pre>
            </section>

            <!-- Garbage Image Review Section -->
            <section id="garbage-review">
                <h2>Garbage Image Review</h2>
                <p>
                    BlueMoxon's AI automatically flags images that don't appear to be book photographs.
                    The Maintenance tab lets you review these flagged images and confirm or override the classification.
                </p>

                <h3>What Gets Flagged</h3>
                <ul>
                    <li><strong>Seller logos:</strong> Watermarks and branding images</li>
                    <li><strong>Screenshots:</strong> Computer or phone screenshots</li>
                    <li><strong>Text images:</strong> Scanned text or certificates</li>
                    <li><strong>Unrelated photos:</strong> Non-book images in listings</li>
                </ul>

                <h3>Reviewing Flagged Images</h3>
                <ol class="steps">
                    <li>Navigate to <strong>Config ‚Üí Maintenance</strong></li>
                    <li>View the list of images flagged as garbage</li>
                    <li>For each image, choose to <strong>Confirm</strong> (delete) or <strong>Keep</strong> (override)</li>
                    <li>Confirmed garbage images are permanently deleted</li>
                </ol>

                <div class="alert alert-info">
                    <strong>Tip:</strong> Images are flagged during AI analysis. If an image is incorrectly
                    flagged, click "Keep" to override and the flag will be removed.
                </div>
            </section>

            <!-- Orphan Cleanup Section -->
            <section id="orphan-cleanup">
                <h2>Orphan Cleanup</h2>
                <p>
                    The Maintenance tab identifies and helps clean up orphaned database records -
                    data that has lost its parent relationship.
                </p>

                <h3>Types of Orphans</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Safe to Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Orphan Images</strong></td>
                            <td>Images with no associated book</td>
                            <td>Yes</td>
                        </tr>
                        <tr>
                            <td><strong>Orphan Analyses</strong></td>
                            <td>Analysis documents with no book</td>
                            <td>Yes</td>
                        </tr>
                        <tr>
                            <td><strong>Orphan Jobs</strong></td>
                            <td>Analysis jobs with no book</td>
                            <td>Yes</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Running Cleanup</h3>
                <ol class="steps">
                    <li>Navigate to <strong>Config ‚Üí Maintenance</strong></li>
                    <li>Click <strong>Detect Orphans</strong> to scan the database</li>
                    <li>Review the list of orphaned records</li>
                    <li>Click <strong>Cleanup Orphans</strong> to remove them</li>
                </ol>

                <div class="alert alert-success">
                    <strong>Safety:</strong> Orphan cleanup only removes records that have no parent.
                    It will never delete images or analyses that belong to existing books.
                </div>
            </section>

            <!-- Dark Mode Section -->
            <section id="dark-mode">
                <h2>Victorian Dark Mode</h2>
                <p>
                    BlueMoxon features an elegant dark theme inspired by Victorian aesthetics.
                    Deep burgundy backgrounds, parchment-colored text, and gold accents create
                    a distinguished reading experience.
                </p>

                <h3>Enabling Dark Mode</h3>
                <ul>
                    <li><strong>Toggle:</strong> Click the moon/sun icon in the navigation bar</li>
                    <li><strong>System sync:</strong> Automatically follows your OS preference</li>
                    <li><strong>Persistence:</strong> Your choice is saved and applied on every visit</li>
                </ul>

                <h3>Color Palette</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Element</th>
                            <th>Light Mode</th>
                            <th>Dark Mode</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Background</strong></td>
                            <td>White (#ffffff)</td>
                            <td>Deep burgundy (#1a0a0f)</td>
                        </tr>
                        <tr>
                            <td><strong>Surface</strong></td>
                            <td>Gray (#f8f9fa)</td>
                            <td>Dark burgundy (#2d1a20)</td>
                        </tr>
                        <tr>
                            <td><strong>Text</strong></td>
                            <td>Dark gray (#1f2937)</td>
                            <td>Parchment (#e8dcc8)</td>
                        </tr>
                        <tr>
                            <td><strong>Accent</strong></td>
                            <td>Blue (#3b82f6)</td>
                            <td>Gold (#c9a227)</td>
                        </tr>
                    </tbody>
                </table>

                <div class="alert alert-info">
                    <strong>Accessibility:</strong> Dark mode respects the <code>prefers-reduced-motion</code>
                    setting. If you have motion reduction enabled, transitions will be minimized.
                </div>
            </section>

        </main>
    </div>

    <footer>
        <div class="footer-links">
            <a href="/">Home</a>
            <a href="/features.html">Features</a>
            <a href="/admin-guide.html">Admin Guide</a>
            <a href="/releases.html">Releases</a>
            <a href="/tech.html">How It's Built</a>
            <a href="https://app.bluemoxon.com" target="_blank">Login</a>
        </div>
        <p>&copy; 2026 BlueMoxon</p>
    </footer>

    <script>
        // Highlight current section in sidebar
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
                    const activeLink = document.querySelector(`.sidebar a[href="#${entry.target.id}"]`);
                    if (activeLink) activeLink.classList.add('active');
                }
            });
        }, { rootMargin: '-100px 0px -80% 0px' });

        document.querySelectorAll('section[id]').forEach(section => observer.observe(section));
    </script>

    <!-- Hamburger menu toggle -->
    <script>
        function toggleMenu() {
            const hamburger = document.querySelector('.hamburger');
            const navLinks = document.querySelector('.nav-links');
            hamburger.classList.toggle('active');
            navLinks.classList.toggle('active');
        }

        // Close menu when clicking a link
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                const hamburger = document.querySelector('.hamburger');
                const navLinks = document.querySelector('.nav-links');
                hamburger.classList.remove('active');
                navLinks.classList.remove('active');
            });
        });
    </script>
</body>
</html>
